<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FUTSAL 2025 FMS Delhi - Tournament Tracker</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #0f4c75 0%, #3282b8 50%, #bbe1fa 100%);
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grass" patternUnits="userSpaceOnUse" width="10" height="10"><rect width="10" height="10" fill="%23ffffff" opacity="0.02"/><path d="M0,5 Q2.5,0 5,5 Q7.5,10 10,5" stroke="%23ffffff" stroke-width="0.5" fill="none" opacity="0.1"/></pattern></defs><rect width="100" height="100" fill="url(%23grass)"/></svg>') repeat;
            z-index: -1;
            animation: grassMove 20s linear infinite;
        }

        @keyframes grassMove {
            0% { transform: translateX(0); }
            100% { transform: translateX(-10px); }
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            border-radius: 25px;
            padding: 40px;
            text-align: center;
            margin-bottom: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '‚öΩ';
            position: absolute;
            font-size: 200px;
            opacity: 0.1;
            top: -50px;
            right: -50px;
            animation: rotate 20s linear infinite;
        }

        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .header h1 {
            font-size: 3.5rem;
            font-weight: 800;
            color: #ffffff;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            animation: glow 2s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from { text-shadow: 2px 2px 4px rgba(0,0,0,0.3), 0 0 20px rgba(255,255,255,0.2); }
            to { text-shadow: 2px 2px 4px rgba(0,0,0,0.3), 0 0 30px rgba(255,255,255,0.4); }
        }

        .header p {
            font-size: 1.3rem;
            color: #e8f4fd;
            font-weight: 300;
        }

        .nav-container {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 10px;
            margin-bottom: 30px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
        }

        .nav-tabs {
            display: flex;
            gap: 5px;
            flex-wrap: wrap;
        }

        .nav-tab {
            flex: 1;
            min-width: 150px;
            padding: 18px 25px;
            background: transparent;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            color: #64748b;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .nav-tab::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            transition: left 0.4s ease;
            z-index: -1;
        }

        .nav-tab.active::before {
            left: 0;
        }

        .nav-tab.active {
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
        }

        .nav-tab:hover:not(.active) {
            background: #f1f5f9;
            transform: translateY(-1px);
        }

        .tab-content {
            display: none;
            animation: fadeInUp 0.6s ease-out;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .card {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 25px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            transition: all 0.4s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 30px 80px rgba(0,0,0,0.15);
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: #1e293b;
            font-size: 1.1rem;
        }

        .form-group input, .form-group select {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 1rem;
            font-family: 'Poppins', sans-serif;
            transition: all 0.3s ease;
            background: rgba(255,255,255,0.8);
        }

        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
            background: white;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            font-family: 'Poppins', sans-serif;
            transition: all 0.3s ease;
            margin-right: 15px;
            margin-bottom: 15px;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
            transition: left 0.3s ease;
            z-index: -1;
        }

        .btn:hover::before {
            left: 0;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(102, 126, 234, 0.4);
        }

        .btn-success {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }

        .btn-success::before {
            background: linear-gradient(135deg, #059669 0%, #10b981 100%);
        }

        .btn-success:hover {
            box-shadow: 0 15px 35px rgba(16, 185, 129, 0.4);
        }

        .btn-danger {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
        }

        .btn-danger::before {
            background: linear-gradient(135deg, #dc2626 0%, #ef4444 100%);
        }

        .btn-danger:hover {
            box-shadow: 0 15px 35px rgba(239, 68, 68, 0.4);
        }

        .team-card {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
            border-left: 6px solid #667eea;
            position: relative;
            overflow: hidden;
            transition: all 0.4s ease;
        }

        .team-card::before {
            content: 'üèÜ';
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 2rem;
            opacity: 0.1;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }

        .team-card:hover {
            transform: translateX(10px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.1);
        }

        .team-name {
            font-size: 1.5rem;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .team-name::before {
            content: '‚öΩ';
            animation: spin 3s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .player-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .player-item {
            background: white;
            padding: 15px;
            border-radius: 12px;
            border: 2px solid #e2e8f0;
            font-size: 1rem;
            font-weight: 500;
            color: #374151;
            transition: all 0.3s ease;
            position: relative;
        }

        .player-item:hover {
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.15);
        }

        .player-item::before {
            content: 'üë§';
            margin-right: 8px;
        }

        .match-card {
            background: white;
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 15px 40px rgba(0,0,0,0.08);
            border: 1px solid #e2e8f0;
            transition: all 0.4s ease;
            position: relative;
            overflow: hidden;
        }

        .match-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, #667eea, #764ba2);
        }

        .match-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 25px 60px rgba(0,0,0,0.12);
        }

        .match-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .match-teams {
            font-size: 1.4rem;
            font-weight: 700;
            color: #1e293b;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .vs-badge {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .match-status {
            padding: 10px 20px;
            border-radius: 25px;
            font-size: 0.9rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .status-pending {
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            color: white;
        }

        .status-completed {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
        }

        .player-stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-top: 25px;
        }

        .team-players {
            background: #f8fafc;
            border-radius: 15px;
            padding: 20px;
        }

        .team-players h4 {
            color: #1e293b;
            margin-bottom: 15px;
            font-size: 1.2rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .player-stat-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid #e2e8f0;
        }

        .player-stat-row:last-child {
            border-bottom: none;
        }

        .player-name {
            font-weight: 500;
            color: #374151;
        }

        .stat-inputs {
            display: flex;
            gap: 10px;
        }

        .stat-input {
            width: 60px;
            padding: 8px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            text-align: center;
            font-size: 0.9rem;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 25px;
        }

        .stats-card {
            background: white;
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 15px 40px rgba(0,0,0,0.08);
            border-left: 6px solid #667eea;
            transition: all 0.4s ease;
            position: relative;
            overflow: hidden;
        }

        .stats-card::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(102, 126, 234, 0.05) 0%, transparent 70%);
            animation: pulse 4s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 0.5; }
            50% { transform: scale(1.1); opacity: 0.8; }
        }

        .stats-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 25px 60px rgba(0,0,0,0.15);
        }

        .stats-header {
            font-size: 1.4rem;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .rank-badge {
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            color: white;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.1rem;
        }

        .rank-badge.first {
            background: linear-gradient(135deg, #ffd700, #ffed4e);
            color: #92400e;
        }

        .rank-badge.second {
            background: linear-gradient(135deg, #c0c0c0, #e5e7eb);
            color: #374151;
        }

        .stat-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #f1f5f9;
        }

        .stat-row:last-child {
            border-bottom: none;
        }

        .stat-label {
            font-weight: 500;
            color: #64748b;
        }

        .stat-value {
            font-weight: 700;
            color: #1e293b;
            font-size: 1.1rem;
        }

        .podium {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            border-radius: 25px;
            padding: 40px;
            margin: 30px 0;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .podium::before {
            content: 'üèÜ';
            position: absolute;
            font-size: 150px;
            opacity: 0.1;
            top: -30px;
            left: 50%;
            transform: translateX(-50%);
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateX(-50%) translateY(0px); }
            50% { transform: translateX(-50%) translateY(-10px); }
        }

        .podium h3 {
            color: white;
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .finalists {
            display: flex;
            justify-content: center;
            gap: 40px;
            flex-wrap: wrap;
        }

        .finalist {
            background: rgba(255,255,255,0.15);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px;
            color: white;
            min-width: 200px;
            border: 2px solid rgba(255,255,255,0.2);
        }

        .finalist h4 {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .finalist-stats {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .alert {
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 25px;
            font-weight: 500;
            border-left: 6px solid;
        }

        .alert-info {
            background: linear-gradient(135deg, #dbeafe, #bfdbfe);
            color: #1e40af;
            border-left-color: #3b82f6;
        }

        .alert-success {
            background: linear-gradient(135deg, #dcfce7, #bbf7d0);
            color: #166534;
            border-left-color: #22c55e;
        }

        .progress-bar {
            background: #e2e8f0;
            border-radius: 10px;
            height: 8px;
            margin: 10px 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            border-radius: 10px;
            transition: width 1s ease;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2.5rem;
            }
            
            .nav-tabs {
                flex-direction: column;
            }
            
            .nav-tab {
                min-width: auto;
            }
            
            .player-stats-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .match-header {
                flex-direction: column;
                align-items: stretch;
            }
            
            .finalists {
                flex-direction: column;
                align-items: center;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }

        /* MVP and Leaderboard Styles */
        .mvp-card {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border-radius: 15px;
            padding: 20px;
            border: 2px solid #e2e8f0;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .mvp-card::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(255, 215, 0, 0.1) 0%, transparent 70%);
            animation: shimmer 3s ease-in-out infinite;
        }

        @keyframes shimmer {
            0%, 100% { transform: scale(1) rotate(0deg); opacity: 0.3; }
            50% { transform: scale(1.1) rotate(180deg); opacity: 0.6; }
        }

        .mvp-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.1);
            border-color: #fbbf24;
        }

        .mvp-player {
            display: flex;
            align-items: center;
            gap: 15px;
            background: white;
            padding: 15px;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }

        .mvp-crown {
            font-size: 2.5rem;
            animation: bounce 2s infinite;
        }

        .mvp-info {
            flex: 1;
        }

        .mvp-name {
            font-size: 1.2rem;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 5px;
        }

        .mvp-team {
            font-size: 0.9rem;
            color: #64748b;
            font-weight: 500;
            margin-bottom: 8px;
        }

        .mvp-stats {
            font-size: 0.9rem;
            color: #059669;
            font-weight: 600;
        }

        .no-stats {
            text-align: center;
            color: #64748b;
            font-style: italic;
            padding: 20px;
            background: #f8fafc;
            border-radius: 10px;
        }

        .leaderboard-section {
            margin-top: 25px;
        }

        .leaderboard-table {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.08);
            border: 1px solid #e2e8f0;
        }

        .leaderboard-header {
            display: grid;
            grid-template-columns: 60px 1fr 120px 80px 80px 100px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-weight: 600;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .leaderboard-header > div {
            padding: 15px 10px;
            text-align: center;
        }

        .leaderboard-row {
            display: grid;
            grid-template-columns: 60px 1fr 120px 80px 80px 100px;
            border-bottom: 1px solid #f1f5f9;
            transition: all 0.3s ease;
        }

        .leaderboard-row:hover {
            background: #f8fafc;
            transform: translateX(5px);
        }

        .leaderboard-row.top-three {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
        }

        .leaderboard-row.top-three:hover {
            background: linear-gradient(135deg, #fde68a 0%, #fbbf24 100%);
        }

        .leaderboard-row > div {
            padding: 15px 10px;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 500;
        }

        .rank-col .rank-badge.third {
            background: linear-gradient(135deg, #cd7f32, #b8860b);
            color: white;
        }

        .player-col {
            text-align: left !important;
            justify-content: flex-start !important;
            font-weight: 600;
            color: #1e293b;
        }

        .team-col {
            font-size: 0.9rem;
            color: #64748b;
        }

        .goals-col, .assists-col {
            font-weight: 600;
            color: #059669;
        }

        .mvp-col {
            font-weight: 700;
            color: #dc2626;
            font-size: 1.1rem;
        }

        .team-performers {
            margin-top: 15px;
        }

        .performer-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #f1f5f9;
        }

        .performer-row:last-child {
            border-bottom: none;
        }

        .performer-label {
            font-size: 0.9rem;
            color: #64748b;
            font-weight: 500;
        }

        .performer-value {
            font-size: 0.9rem;
            color: #1e293b;
            font-weight: 600;
        }

        @media (max-width: 768px) {
            .leaderboard-header,
            .leaderboard-row {
                grid-template-columns: 50px 1fr 100px 60px 60px 80px;
                font-size: 0.8rem;
            }

            .leaderboard-header > div,
            .leaderboard-row > div {
                padding: 12px 5px;
            }

            .mvp-player {
                flex-direction: column;
                text-align: center;
                gap: 10px;
            }

            .mvp-crown {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>‚öΩ FUTSAL 2025 FMS Delhi</h1>
            <p>Professional Tournament Management System</p>
        </div>

        <div class="nav-container">
            <div class="nav-tabs">
                <button class="nav-tab active" onclick="showTab('teams')">Teams & Players</button>
                <button class="nav-tab" onclick="showTab('schedule')">Match Schedule</button>
                <button class="nav-tab" onclick="showTab('results')">Game Logs</button>
                <button class="nav-tab" onclick="showTab('stats')">Statistics</button>
                <button class="nav-tab" id="finalsTab" onclick="showTab('finals')" style="display: none;">Finals</button>
            </div>
        </div>

        <!-- Teams Tab -->
        <div id="teams" class="tab-content active">
            <div class="card">
                <h2 style="color: #1e293b; margin-bottom: 25px; font-size: 2rem; font-weight: 700;">Team Registration</h2>
                <div class="alert alert-info">
                    <strong>üèÜ Tournament Setup:</strong> Register 4 teams with exactly 7 players each for the ultimate football showdown!
                </div>
                
                <div class="form-group">
                    <label for="teamName">Team Name:</label>
                    <input type="text" id="teamName" placeholder="Enter your team name">
                </div>
                
                <div class="form-group">
                    <label for="playerName">Add Players (one at a time):</label>
                    <input type="text" id="playerName" placeholder="Enter player name">
                    <button class="btn" onclick="addPlayer()">Add Player</button>
                </div>
                
                <div id="currentTeamPlayers"></div>
                
                <button class="btn btn-success" onclick="saveTeam()">Save Team</button>
                <button class="btn" onclick="clearCurrentTeam()">Clear</button>
            </div>
            
            <div id="teamsDisplay"></div>
        </div>

        <!-- Schedule Tab -->
        <div id="schedule" class="tab-content">
            <div class="card">
                <h2 style="color: #1e293b; margin-bottom: 25px; font-size: 2rem; font-weight: 700;">Match Schedule</h2>
                <div class="alert alert-info">
                    <strong>‚öΩ Round-Robin Format:</strong> Each team faces every other team once. The schedule generates automatically when all 4 teams are registered.
                </div>
                
                <button class="btn" onclick="generateSchedule()">Generate Schedule</button>
            </div>
            <div id="scheduleDisplay"></div>
        </div>

        <!-- Results Tab -->
        <div id="results" class="tab-content">
            <div class="card">
                <h2 style="color: #1e293b; margin-bottom: 25px; font-size: 2rem; font-weight: 700;">Game Logs</h2>
                <div class="alert alert-info">
                    <strong>üìä Detailed Match Recording:</strong> Log match results and individual player statistics (goals & assists) for comprehensive tracking.
                </div>
            </div>
            <div id="resultsDisplay"></div>
        </div>

        <!-- Statistics Tab -->
        <div id="stats" class="tab-content">
            <div class="card">
                <h2 style="color: #1e293b; margin-bottom: 25px; font-size: 2rem; font-weight: 700;">Tournament Statistics</h2>
            </div>
            <div id="statsDisplay"></div>
            <div id="podiumDisplay"></div>
        </div>

        <!-- Finals Tab -->
        <div id="finals" class="tab-content">
            <div class="card">
                <h2 style="color: #1e293b; margin-bottom: 25px; font-size: 2rem; font-weight: 700;">Championship Final</h2>
                <div class="alert alert-success">
                    <strong>üèÜ The Ultimate Showdown:</strong> The top 2 teams battle for championship glory!
                </div>
            </div>
            <div id="finalsDisplay"></div>
        </div>
    </div>

    <script>
        // Tournament data
        let teams = [];
        let matches = [];
        let finalMatch = null;
        let currentTeam = { name: '', players: [] };

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            updateTeamsDisplay();
            updateScheduleDisplay();
            updateResultsDisplay();
            updateStatsDisplay();
        });

        // Tab functionality
        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });

            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');

            if (tabName === 'schedule') updateScheduleDisplay();
            if (tabName === 'results') updateResultsDisplay();
            if (tabName === 'stats') updateStatsDisplay();
            if (tabName === 'finals') updateFinalsDisplay();
        }

        // Team management
        function addPlayer() {
            const playerName = document.getElementById('playerName').value.trim();
            if (!playerName) {
                alert('Please enter a player name');
                return;
            }

            if (currentTeam.players.length >= 7) {
                alert('Maximum 7 players per team');
                return;
            }

            currentTeam.players.push(playerName);
            document.getElementById('playerName').value = '';
            updateCurrentTeamDisplay();
        }

        function updateCurrentTeamDisplay() {
            const display = document.getElementById('currentTeamPlayers');
            if (currentTeam.players.length === 0) {
                display.innerHTML = '';
                return;
            }

            let html = `
                <div class="team-card">
                    <h4 style="color: #1e293b; margin-bottom: 15px;">Current Team Players (${currentTeam.players.length}/7):</h4>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${(currentTeam.players.length / 7) * 100}%"></div>
                    </div>
                    <div class="player-grid">
            `;
            
            currentTeam.players.forEach((player, index) => {
                html += `<div class="player-item">${player}</div>`;
            });
            
            html += '</div></div>';
            display.innerHTML = html;
        }

        function saveTeam() {
            const teamName = document.getElementById('teamName').value.trim();
            
            if (!teamName) {
                alert('Please enter a team name');
                return;
            }

            if (currentTeam.players.length !== 7) {
                alert('Each team must have exactly 7 players');
                return;
            }

            if (teams.length >= 4) {
                alert('Maximum 4 teams allowed for this tournament');
                return;
            }

            if (teams.some(team => team.name.toLowerCase() === teamName.toLowerCase())) {
                alert('Team name already exists');
                return;
            }

            teams.push({
                name: teamName,
                players: [...currentTeam.players],
                stats: {
                    played: 0,
                    won: 0,
                    drawn: 0,
                    lost: 0,
                    goalsFor: 0,
                    goalsAgainst: 0,
                    goalDifference: 0,
                    points: 0,
                    assists: 0
                },
                playerStats: currentTeam.players.map(player => ({
                    name: player,
                    goals: 0,
                    assists: 0
                }))
            });

            currentTeam = { name: '', players: [] };
            document.getElementById('teamName').value = '';
            document.getElementById('playerName').value = '';
            updateCurrentTeamDisplay();
            updateTeamsDisplay();
        }

        function clearCurrentTeam() {
            currentTeam = { name: '', players: [] };
            document.getElementById('teamName').value = '';
            document.getElementById('playerName').value = '';
            updateCurrentTeamDisplay();
        }

        function updateTeamsDisplay() {
            const display = document.getElementById('teamsDisplay');
            if (teams.length === 0) {
                display.innerHTML = '<div class="alert alert-info">No teams registered yet. Create your first team above!</div>';
                return;
            }

            let html = '';
            teams.forEach((team, index) => {
                html += `
                    <div class="team-card">
                        <div class="team-name">${team.name}</div>
                        <div class="player-grid">
                            ${team.players.map(player => 
                                `<div class="player-item">${player}</div>`
                            ).join('')}
                        </div>
                        <button class="btn btn-danger" onclick="removeTeam(${index})">Remove Team</button>
                    </div>
                `;
            });

            if (teams.length === 4) {
                html += '<div class="alert alert-success"><strong>üéâ All teams registered!</strong> Ready to generate the tournament schedule.</div>';
            } else {
                html += `<div class="alert alert-info">Teams registered: ${teams.length}/4. Need ${4 - teams.length} more team(s) to start the tournament.</div>`;
            }

            display.innerHTML = html;
        }

        function removeTeam(index) {
            if (confirm('Are you sure you want to remove this team?')) {
                teams.splice(index, 1);
                matches = [];
                finalMatch = null;
                document.getElementById('finalsTab').style.display = 'none';
                updateTeamsDisplay();
                updateScheduleDisplay();
                updateResultsDisplay();
                updateStatsDisplay();
            }
        }

        // Schedule generation
        function generateSchedule() {
            if (teams.length !== 4) {
                alert('You need exactly 4 teams to generate the schedule');
                return;
            }

            matches = [];
            let matchId = 1;

            for (let i = 0; i < teams.length; i++) {
                for (let j = i + 1; j < teams.length; j++) {
                    matches.push({
                        id: matchId++,
                        team1: teams[i].name,
                        team2: teams[j].name,
                        score1: null,
                        score2: null,
                        completed: false,
                        playerStats: {
                            [teams[i].name]: teams[i].players.map(player => ({ name: player, goals: 0, assists: 0 })),
                            [teams[j].name]: teams[j].players.map(player => ({ name: player, goals: 0, assists: 0 }))
                        }
                    });
                }
            }

            updateScheduleDisplay();
            updateResultsDisplay();
        }

        function updateScheduleDisplay() {
            const display = document.getElementById('scheduleDisplay');
            
            if (matches.length === 0) {
                display.innerHTML = '<div class="alert alert-info">No matches scheduled. Generate schedule when you have 4 teams.</div>';
                return;
            }

            let html = '';
            matches.forEach(match => {
                html += `
                    <div class="match-card">
                        <div class="match-header">
                            <div class="match-teams">
                                ${match.team1} <span class="vs-badge">VS</span> ${match.team2}
                            </div>
                            <div class="match-status ${match.completed ? 'status-completed' : 'status-pending'}">
                                ${match.completed ? 'Completed' : 'Pending'}
                            </div>
                        </div>
                        ${match.completed ? `
                            <div style="text-align: center; font-size: 1.5rem; font-weight: 700; color: #1e293b;">
                                Final Score: ${match.team1} ${match.score1} - ${match.score2} ${match.team2}
                            </div>
                        ` : ''}
                    </div>
                `;
            });

            display.innerHTML = html;
        }

        // Results management
        function updateResultsDisplay() {
            const display = document.getElementById('resultsDisplay');
            
            if (matches.length === 0) {
                display.innerHTML = '<div class="alert alert-info">No matches to record results for. Generate schedule first.</div>';
                return;
            }

            let html = '';
            const pendingMatches = matches.filter(m => !m.completed);
            
            if (pendingMatches.length === 0) {
                html = '<div class="alert alert-success">All matches completed! Check the Statistics tab for final standings.</div>';
            } else {
                pendingMatches.forEach(match => {
                    html += `
                        <div class="match-card">
                            <div class="match-header">
                                <div class="match-teams">
                                    ${match.team1} <span class="vs-badge">VS</span> ${match.team2}
                                </div>
                            </div>
                            
                            <div style="display: flex; justify-content: center; align-items: center; gap: 20px; margin: 20px 0;">
                                <input type="number" id="score1_${match.id}" min="0" placeholder="0" style="width: 80px; text-align: center; font-size: 1.2rem; font-weight: 700;">
                                <span style="font-size: 1.5rem; font-weight: 700;">-</span>
                                <input type="number" id="score2_${match.id}" min="0" placeholder="0" style="width: 80px; text-align: center; font-size: 1.2rem; font-weight: 700;">
                            </div>

                            <div class="player-stats-grid">
                                <div class="team-players">
                                    <h4>‚öΩ ${match.team1} Players</h4>
                                    ${match.playerStats[match.team1].map((player, index) => `
                                        <div class="player-stat-row">
                                            <span class="player-name">${player.name}</span>
                                            <div class="stat-inputs">
                                                <input type="number" class="stat-input" id="goals_${match.id}_${match.team1}_${index}" min="0" placeholder="G" title="Goals">
                                                <input type="number" class="stat-input" id="assists_${match.id}_${match.team1}_${index}" min="0" placeholder="A" title="Assists">
                                            </div>
                                        </div>
                                    `).join('')}
                                </div>
                                
                                <div class="team-players">
                                    <h4>‚öΩ ${match.team2} Players</h4>
                                    ${match.playerStats[match.team2].map((player, index) => `
                                        <div class="player-stat-row">
                                            <span class="player-name">${player.name}</span>
                                            <div class="stat-inputs">
                                                <input type="number" class="stat-input" id="goals_${match.id}_${match.team2}_${index}" min="0" placeholder="G" title="Goals">
                                                <input type="number" class="stat-input" id="assists_${match.id}_${match.team2}_${index}" min="0" placeholder="A" title="Assists">
                                            </div>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                            
                            <div style="text-align: center; margin-top: 25px;">
                                <button class="btn btn-success" onclick="recordResult(${match.id})">Record Match Result</button>
                            </div>
                        </div>
                    `;
                });
            }

            display.innerHTML = html;
        }

        function recordResult(matchId) {
            const match = matches.find(m => m.id === matchId);
            const score1 = parseInt(document.getElementById(`score1_${matchId}`).value) || 0;
            const score2 = parseInt(document.getElementById(`score2_${matchId}`).value) || 0;

            match.score1 = score1;
            match.score2 = score2;
            match.completed = true;

            // Record player stats
            [match.team1, match.team2].forEach(teamName => {
                match.playerStats[teamName].forEach((player, index) => {
                    const goals = parseInt(document.getElementById(`goals_${matchId}_${teamName}_${index}`).value) || 0;
                    const assists = parseInt(document.getElementById(`assists_${matchId}_${teamName}_${index}`).value) || 0;
                    
                    player.goals = goals;
                    player.assists = assists;
                });
            });

            updateTeamStats();
            updateScheduleDisplay();
            updateResultsDisplay();
            updateStatsDisplay();
            checkForFinals();
        }

        function updateTeamStats() {
            // Reset all stats
            teams.forEach(team => {
                team.stats = {
                    played: 0,
                    won: 0,
                    drawn: 0,
                    lost: 0,
                    goalsFor: 0,
                    goalsAgainst: 0,
                    goalDifference: 0,
                    points: 0,
                    assists: 0
                };
                team.playerStats.forEach(player => {
                    player.goals = 0;
                    player.assists = 0;
                });
            });

            // Calculate stats from completed matches
            matches.forEach(match => {
                if (match.completed) {
                    const team1 = teams.find(t => t.name === match.team1);
                    const team2 = teams.find(t => t.name === match.team2);

                    team1.stats.played++;
                    team2.stats.played++;
                    team1.stats.goalsFor += match.score1;
                    team1.stats.goalsAgainst += match.score2;
                    team2.stats.goalsFor += match.score2;
                    team2.stats.goalsAgainst += match.score1;

                    if (match.score1 > match.score2) {
                        team1.stats.won++;
                        team1.stats.points += 3;
                        team2.stats.lost++;
                    } else if (match.score1 < match.score2) {
                        team2.stats.won++;
                        team2.stats.points += 3;
                        team1.stats.lost++;
                    } else {
                        team1.stats.drawn++;
                        team2.stats.drawn++;
                        team1.stats.points += 1;
                        team2.stats.points += 1;
                    }

                    team1.stats.goalDifference = team1.stats.goalsFor - team1.stats.goalsAgainst;
                    team2.stats.goalDifference = team2.stats.goalsFor - team2.stats.goalsAgainst;

                    // Update player stats
                    [match.team1, match.team2].forEach(teamName => {
                        const team = teams.find(t => t.name === teamName);
                        match.playerStats[teamName].forEach(matchPlayer => {
                            const teamPlayer = team.playerStats.find(p => p.name === matchPlayer.name);
                            if (teamPlayer) {
                                teamPlayer.goals += matchPlayer.goals;
                                teamPlayer.assists += matchPlayer.assists;
                            }
                        });
                        
                        team.stats.assists = team.playerStats.reduce((sum, player) => sum + player.assists, 0);
                    });
                }
            });
        }

        function updateStatsDisplay() {
            const display = document.getElementById('statsDisplay');
            const podiumDisplay = document.getElementById('podiumDisplay');
            
            if (teams.length === 0) {
                display.innerHTML = '<div class="alert alert-info">No teams registered yet.</div>';
                podiumDisplay.innerHTML = '';
                return;
            }

            const sortedTeams = [...teams].sort((a, b) => {
                if (b.stats.points !== a.stats.points) return b.stats.points - a.stats.points;
                if (b.stats.goalDifference !== a.stats.goalDifference) return b.stats.goalDifference - a.stats.goalDifference;
                return b.stats.goalsFor - a.stats.goalsFor;
            });

            // Calculate all players with MVP points (goals * 2 + assists * 1)
            let allPlayers = [];
            teams.forEach(team => {
                team.playerStats.forEach(player => {
                    if (player.goals > 0 || player.assists > 0) {
                        allPlayers.push({
                            name: player.name,
                            team: team.name,
                            goals: player.goals,
                            assists: player.assists,
                            mvpPoints: (player.goals * 2) + (player.assists * 1)
                        });
                    }
                });
            });

            // Sort players by MVP points
            allPlayers.sort((a, b) => {
                if (b.mvpPoints !== a.mvpPoints) return b.mvpPoints - a.mvpPoints;
                if (b.goals !== a.goals) return b.goals - a.goals;
                return b.assists - a.assists;
            });

            let html = `
                <!-- Tournament MVP & Player Leaderboards -->
                <div class="card" style="margin-bottom: 30px;">
                    <h3 style="color: #1e293b; margin-bottom: 25px; font-size: 1.8rem; font-weight: 700; text-align: center;">
                        üèÜ Tournament MVP & Player Leaderboards
                    </h3>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 25px; margin-bottom: 30px;">
                        <!-- Overall MVP -->
                        <div class="mvp-card">
                            <h4 style="color: #1e293b; margin-bottom: 15px; font-size: 1.3rem; font-weight: 600; text-align: center;">
                                üëë Tournament MVP
                            </h4>
                            ${allPlayers.length > 0 ? `
                                <div class="mvp-player">
                                    <div class="mvp-crown">üèÜ</div>
                                    <div class="mvp-info">
                                        <div class="mvp-name">${allPlayers[0].name}</div>
                                        <div class="mvp-team">${allPlayers[0].team}</div>
                                        <div class="mvp-stats">
                                            ${allPlayers[0].goals}G ‚Ä¢ ${allPlayers[0].assists}A ‚Ä¢ ${allPlayers[0].mvpPoints} MVP Points
                                        </div>
                                    </div>
                                </div>
                            ` : '<div class="no-stats">No player statistics yet</div>'}
                        </div>

                        <!-- Top Goal Scorer -->
                        <div class="mvp-card">
                            <h4 style="color: #1e293b; margin-bottom: 15px; font-size: 1.3rem; font-weight: 600; text-align: center;">
                                ‚öΩ Top Goal Scorer
                            </h4>
                            ${allPlayers.length > 0 ? (() => {
                                const topScorer = [...allPlayers].sort((a, b) => {
                                    if (b.goals !== a.goals) return b.goals - a.goals;
                                    return b.assists - a.assists;
                                })[0];
                                return `
                                    <div class="mvp-player">
                                        <div class="mvp-crown">‚öΩ</div>
                                        <div class="mvp-info">
                                            <div class="mvp-name">${topScorer.name}</div>
                                            <div class="mvp-team">${topScorer.team}</div>
                                            <div class="mvp-stats">
                                                ${topScorer.goals} Goals ‚Ä¢ ${topScorer.assists} Assists
                                            </div>
                                        </div>
                                    </div>
                                `;
                            })() : '<div class="no-stats">No goals scored yet</div>'}
                        </div>

                        <!-- Top Assist Provider -->
                        <div class="mvp-card">
                            <h4 style="color: #1e293b; margin-bottom: 15px; font-size: 1.3rem; font-weight: 600; text-align: center;">
                                üéØ Top Assist Provider
                            </h4>
                            ${allPlayers.length > 0 ? (() => {
                                const topAssister = [...allPlayers].sort((a, b) => {
                                    if (b.assists !== a.assists) return b.assists - a.assists;
                                    return b.goals - a.goals;
                                })[0];
                                return `
                                    <div class="mvp-player">
                                        <div class="mvp-crown">üéØ</div>
                                        <div class="mvp-info">
                                            <div class="mvp-name">${topAssister.name}</div>
                                            <div class="mvp-team">${topAssister.team}</div>
                                            <div class="mvp-stats">
                                                ${topAssister.assists} Assists ‚Ä¢ ${topAssister.goals} Goals
                                            </div>
                                        </div>
                                    </div>
                                `;
                            })() : '<div class="no-stats">No assists recorded yet</div>'}
                        </div>
                    </div>

                    <!-- Overall Player Leaderboard -->
                    <div class="leaderboard-section">
                        <h4 style="color: #1e293b; margin-bottom: 20px; font-size: 1.4rem; font-weight: 600; text-align: center;">
                            üìä Complete Player Leaderboard
                        </h4>
                        <div class="leaderboard-table">
                            <div class="leaderboard-header">
                                <div class="rank-col">Rank</div>
                                <div class="player-col">Player</div>
                                <div class="team-col">Team</div>
                                <div class="goals-col">Goals</div>
                                <div class="assists-col">Assists</div>
                                <div class="mvp-col">MVP Points</div>
                            </div>
                            ${allPlayers.length > 0 ? allPlayers.slice(0, 10).map((player, index) => `
                                <div class="leaderboard-row ${index < 3 ? 'top-three' : ''}">
                                    <div class="rank-col">
                                        <span class="rank-badge ${index === 0 ? 'first' : index === 1 ? 'second' : index === 2 ? 'third' : ''}">${index + 1}</span>
                                    </div>
                                    <div class="player-col">${player.name}</div>
                                    <div class="team-col">${player.team}</div>
                                    <div class="goals-col">${player.goals}</div>
                                    <div class="assists-col">${player.assists}</div>
                                    <div class="mvp-col"><strong>${player.mvpPoints}</strong></div>
                                </div>
                            `).join('') : '<div class="no-stats" style="grid-column: 1 / -1; text-align: center; padding: 20px;">No player statistics available yet</div>'}
                        </div>
                    </div>
                </div>

                <!-- Team Statistics -->
                <h3 style="color: #1e293b; margin-bottom: 25px; font-size: 1.8rem; font-weight: 700; text-align: center;">
                    üìà Team Statistics & Top Performers
                </h3>
                <div class="stats-grid">
            `;

            sortedTeams.forEach((team, index) => {
                const rankClass = index === 0 ? 'first' : index === 1 ? 'second' : '';
                
                // Get top performers for this team
                const teamPlayers = team.playerStats.filter(p => p.goals > 0 || p.assists > 0)
                    .map(p => ({...p, mvpPoints: (p.goals * 2) + p.assists}))
                    .sort((a, b) => {
                        if (b.mvpPoints !== a.mvpPoints) return b.mvpPoints - a.mvpPoints;
                        if (b.goals !== a.goals) return b.goals - a.goals;
                        return b.assists - a.assists;
                    });

                const topScorer = [...teamPlayers].sort((a, b) => b.goals - a.goals)[0];
                const topAssister = [...teamPlayers].sort((a, b) => b.assists - a.assists)[0];

                html += `
                    <div class="stats-card">
                        <div class="stats-header">
                            <div class="rank-badge ${rankClass}">${index + 1}</div>
                            ${team.name}
                        </div>
                        
                        <!-- Team Stats -->
                        <div class="stat-row"><span class="stat-label">Matches Played:</span><span class="stat-value">${team.stats.played}</span></div>
                        <div class="stat-row"><span class="stat-label">Won:</span><span class="stat-value">${team.stats.won}</span></div>
                        <div class="stat-row"><span class="stat-label">Drawn:</span><span class="stat-value">${team.stats.drawn}</span></div>
                        <div class="stat-row"><span class="stat-label">Lost:</span><span class="stat-value">${team.stats.lost}</span></div>
                        <div class="stat-row"><span class="stat-label">Goals For:</span><span class="stat-value">${team.stats.goalsFor}</span></div>
                        <div class="stat-row"><span class="stat-label">Goals Against:</span><span class="stat-value">${team.stats.goalsAgainst}</span></div>
                        <div class="stat-row"><span class="stat-label">Goal Difference:</span><span class="stat-value">${team.stats.goalDifference > 0 ? '+' : ''}${team.stats.goalDifference}</span></div>
                        <div class="stat-row"><span class="stat-label">Total Assists:</span><span class="stat-value">${team.stats.assists}</span></div>
                        <div class="stat-row"><span class="stat-label"><strong>Points:</strong></span><span class="stat-value"><strong>${team.stats.points}</strong></span></div>
                        
                        <!-- Team Top Performers -->
                        <div class="team-performers">
                            <h5 style="color: #1e293b; margin: 20px 0 15px 0; font-size: 1.1rem; font-weight: 600; border-top: 2px solid #e2e8f0; padding-top: 15px;">
                                üåü Top Performers
                            </h5>
                            
                            ${teamPlayers.length > 0 ? `
                                <div class="performer-row">
                                    <span class="performer-label">üëë Team MVP:</span>
                                    <span class="performer-value">${teamPlayers[0].name} (${teamPlayers[0].mvpPoints} pts)</span>
                                </div>
                                ${topScorer ? `
                                    <div class="performer-row">
                                        <span class="performer-label">‚öΩ Top Scorer:</span>
                                        <span class="performer-value">${topScorer.name} (${topScorer.goals}G)</span>
                                    </div>
                                ` : ''}
                                ${topAssister && topAssister.assists > 0 ? `
                                    <div class="performer-row">
                                        <span class="performer-label">üéØ Top Assister:</span>
                                        <span class="performer-value">${topAssister.name} (${topAssister.assists}A)</span>
                                    </div>
                                ` : ''}
                            ` : '<div class="no-stats">No player statistics yet</div>'}
                        </div>
                    </div>
                `;
            });
            html += '</div>';

            display.innerHTML = html;

            // Show podium if round-robin is complete
            const completedMatches = matches.filter(m => m.completed).length;
            if (completedMatches === 6 && matches.length === 6) {
                const top2Teams = sortedTeams.slice(0, 2);
                podiumDisplay.innerHTML = `
                    <div class="podium">
                        <h3>üèÜ Championship Finalists</h3>
                        <div class="finalists">
                            <div class="finalist">
                                <h4>ü•á ${top2Teams[0].name}</h4>
                                <div class="finalist-stats">
                                    ${top2Teams[0].stats.points} points | ${top2Teams[0].stats.goalDifference > 0 ? '+' : ''}${top2Teams[0].stats.goalDifference} GD
                                </div>
                            </div>
                            <div class="finalist">
                                <h4>ü•à ${top2Teams[1].name}</h4>
                                <div class="finalist-stats">
                                    ${top2Teams[1].stats.points} points | ${top2Teams[1].stats.goalDifference > 0 ? '+' : ''}${top2Teams[1].stats.goalDifference} GD
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            } else {
                podiumDisplay.innerHTML = '';
            }
        }

        function checkForFinals() {
            const completedMatches = matches.filter(m => m.completed).length;
            if (completedMatches === 6 && matches.length === 6) {
                const sortedTeams = [...teams].sort((a, b) => {
                    if (b.stats.points !== a.stats.points) return b.stats.points - a.stats.points;
                    if (b.stats.goalDifference !== a.stats.goalDifference) return b.stats.goalDifference - a.stats.goalDifference;
                    return b.stats.goalsFor - a.stats.goalsFor;
                });

                const top2Teams = sortedTeams.slice(0, 2);
                
                if (!finalMatch) {
                    finalMatch = {
                        id: 'final',
                        team1: top2Teams[0].name,
                        team2: top2Teams[1].name,
                        score1: null,
                        score2: null,
                        completed: false,
                        playerStats: {
                            [top2Teams[0].name]: top2Teams[0].players.map(player => ({ name: player, goals: 0, assists: 0 })),
                            [top2Teams[1].name]: top2Teams[1].players.map(player => ({ name: player, goals: 0, assists: 0 }))
                        }
                    };
                }

                document.getElementById('finalsTab').style.display = 'block';
                updateFinalsDisplay();
            }
        }

        function updateFinalsDisplay() {
            const display = document.getElementById('finalsDisplay');
            
            if (!finalMatch) {
                display.innerHTML = '<div class="alert alert-info">Finals will be available after the round-robin stage is complete.</div>';
                return;
            }

            if (finalMatch.completed) {
                display.innerHTML = `
                    <div class="match-card">
                        <div class="match-header">
                            <div class="match-teams">
                                üèÜ CHAMPIONSHIP FINAL üèÜ
                            </div>
                        </div>
                        <div style="text-align: center; font-size: 2rem; font-weight: 700; color: #1e293b; margin: 30px 0;">
                            ${finalMatch.team1} ${finalMatch.score1} - ${finalMatch.score2} ${finalMatch.team2}
                        </div>
                        <div style="text-align: center; font-size: 1.5rem; color: #059669; font-weight: 700;">
                            üéâ ${finalMatch.score1 > finalMatch.score2 ? finalMatch.team1 : finalMatch.score1 < finalMatch.score2 ? finalMatch.team2 : 'Draw'} 
                            ${finalMatch.score1 !== finalMatch.score2 ? 'WINS THE CHAMPIONSHIP!' : 'SHARED CHAMPIONSHIP!'}
                        </div>
                    </div>
                `;
            } else {
                display.innerHTML = `
                    <div class="match-card">
                        <div class="match-header">
                            <div class="match-teams">
                                üèÜ ${finalMatch.team1} <span class="vs-badge">FINAL</span> ${finalMatch.team2} üèÜ
                            </div>
                        </div>
                        
                        <div style="display: flex; justify-content: center; align-items: center; gap: 20px; margin: 20px 0;">
                            <input type="number" id="finalScore1" min="0" placeholder="0" style="width: 80px; text-align: center; font-size: 1.2rem; font-weight: 700;">
                            <span style="font-size: 1.5rem; font-weight: 700;">-</span>
                            <input type="number" id="finalScore2" min="0" placeholder="0" style="width: 80px; text-align: center; font-size: 1.2rem; font-weight: 700;">
                        </div>

                        <div class="player-stats-grid">
                            <div class="team-players">
                                <h4>‚öΩ ${finalMatch.team1} Players</h4>
                                ${finalMatch.playerStats[finalMatch.team1].map((player, index) => `
                                    <div class="player-stat-row">
                                        <span class="player-name">${player.name}</span>
                                        <div class="stat-inputs">
                                            <input type="number" class="stat-input" id="finalGoals_${finalMatch.team1}_${index}" min="0" placeholder="G" title="Goals">
                                            <input type="number" class="stat-input" id="finalAssists_${finalMatch.team1}_${index}" min="0" placeholder="A" title="Assists">
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                            
                            <div class="team-players">
                                <h4>‚öΩ ${finalMatch.team2} Players</h4>
                                ${finalMatch.playerStats[finalMatch.team2].map((player, index) => `
                                    <div class="player-stat-row">
                                        <span class="player-name">${player.name}</span>
                                        <div class="stat-inputs">
                                            <input type="number" class="stat-input" id="finalGoals_${finalMatch.team2}_${index}" min="0" placeholder="G" title="Goals">
                                            <input type="number" class="stat-input" id="finalAssists_${finalMatch.team2}_${index}" min="0" placeholder="A" title="Assists">
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                        
                        <div style="text-align: center; margin-top: 25px;">
                            <button class="btn btn-success" onclick="recordFinalResult()">üèÜ Record Championship Result</button>
                        </div>
                    </div>
                `;
            }
        }

        function recordFinalResult() {
            const score1 = parseInt(document.getElementById('finalScore1').value) || 0;
            const score2 = parseInt(document.getElementById('finalScore2').value) || 0;

            finalMatch.score1 = score1;
            finalMatch.score2 = score2;
            finalMatch.completed = true;

            // Record player stats
            [finalMatch.team1, finalMatch.team2].forEach(teamName => {
                finalMatch.playerStats[teamName].forEach((player, index) => {
                    const goals = parseInt(document.getElementById(`finalGoals_${teamName}_${index}`).value) || 0;
                    const assists = parseInt(document.getElementById(`finalAssists_${teamName}_${index}`).value) || 0;
                    
                    player.goals = goals;
                    player.assists = assists;

                    // Update the main team player stats with final match stats
                    const team = teams.find(t => t.name === teamName);
                    if (team) {
                        const teamPlayer = team.playerStats.find(p => p.name === player.name);
                        if (teamPlayer) {
                            teamPlayer.goals += goals;
                            teamPlayer.assists += assists;
                        }
                    }
                });
            });

            // Update team stats with final match results
            const team1 = teams.find(t => t.name === finalMatch.team1);
            const team2 = teams.find(t => t.name === finalMatch.team2);
            
            if (team1 && team2) {
                team1.stats.played++;
                team2.stats.played++;
                team1.stats.goalsFor += score1;
                team1.stats.goalsAgainst += score2;
                team2.stats.goalsFor += score2;
                team2.stats.goalsAgainst += score1;

                if (score1 > score2) {
                    team1.stats.won++;
                    team1.stats.points += 3;
                    team2.stats.lost++;
                } else if (score1 < score2) {
                    team2.stats.won++;
                    team2.stats.points += 3;
                    team1.stats.lost++;
                } else {
                    team1.stats.drawn++;
                    team2.stats.drawn++;
                    team1.stats.points += 1;
                    team2.stats.points += 1;
                }

                team1.stats.goalDifference = team1.stats.goalsFor - team1.stats.goalsAgainst;
                team2.stats.goalDifference = team2.stats.goalsFor - team2.stats.goalsAgainst;
                team1.stats.assists = team1.playerStats.reduce((sum, player) => sum + player.assists, 0);
                team2.stats.assists = team2.playerStats.reduce((sum, player) => sum + player.assists, 0);
            }

            updateFinalsDisplay();
            updateStatsDisplay(); // This will refresh the player leaderboards with final match stats
        }

        // Event listeners
        document.getElementById('playerName').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                addPlayer();
            }
        });

        document.getElementById('teamName').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                document.getElementById('playerName').focus();
            }
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'966f8240f276a7e5',t:'MTc1MzgyMjQ0MC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
